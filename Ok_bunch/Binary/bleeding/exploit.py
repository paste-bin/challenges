#!/usr/bin/python

lag{_bl333ding_a_flag!_}

from pwn import *

key = chr(0xc0)+chr(0xfe)+chr(0xba)+chr(0xbe)+chr(0x3b)+chr(0x30)

context.log_level = 50

def zor(hand1, hand2):
	return [chr(ord(finger1) ^ ord(finger2)) for finger1, finger2 in zip(hand1, hand2)]


def get_rec(seed):
	conn = process(["./bleeding_client", "35.163.169.111","1337"])
	# welcome
	conn.recvuntil("\n")

	conn.sendline(seed)
	conn.recvuntil("Your Encrypted Key is: ")
	rec = conn.recv(0xc8)
	return rec





recs = []

rec0 = key*10

for x in range(10):
	rec = get_rec('0')
	print zor(rec, rec0)
	recs += rec











