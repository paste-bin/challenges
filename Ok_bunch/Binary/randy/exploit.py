#!/usr/bin/env python
# -*- coding: utf-8 -*-
from pwn import *
from struct import pack, unpack


count = 0
#conn = remote("4.31.182.242", 9002) 
conn = process('./randy_noflag')


# Welcome message
front_line = conn.recvuntil("\n")

print conn.recvuntil("\n")

mark = 'DebugInfo:'
index = front_line.index(mark)
byte_string = front_line[index + len(mark):]
print front_line
bytes = [unpack('<B', x)[0] for x in byte_string]
# print bytes
mod_bytes = [(x-0x41)%256 for x in bytes]

if len(mod_bytes) != 6:
	exit()

rand_bytes = mod_bytes[1:-1]

payload = ''

for byte in rand_bytes:
	payload += pack('<B', int(byte))

payload = payload[::-1]


conn.sendline(payload)
print conn.recvuntil("\n")
conn.close()


