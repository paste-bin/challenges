pdisas 0x6c4
b *0x000006e0
r < payload
b do_the_format+28
b do_the_format + 28
b do_the_format
q
b do_the_format + 28
b do_the_format
r < payload 
ni
x/10wx 0x2018
p puts
q
start
x/10wx 0x2018
p puts
pltbreak puts
r < payload
q
checksec
aslr
start
aslr
q
start
x/100wx 0x201c
vmmap
q
x/100wx 0x500
vmap
vmmap
ni
x/100wx 0x2018
x/100wx 0x4d6
vmmap
start
vmmap
b _start
r
r
r
r
r
r
q
b _start
r
ni
c
q
break printf
run
c
stack 20
stack 100
vmmap
pdisas 0xf7fd7000
run
c
stack 100
checksec
q
break printf
run < payload
x/10wx 0x1fe4
checksec
q
checksec
start
checksec
quit
checksec
quit
checksec
quit
checksec
quit
checksec
quit
checksec
quit
checksec
quit
checksec
quit
checksec
quit
checksec
quit
checksec
quit
checksec
quit
checksec
q
checksec
quit
checksec
quit
checksec
quit
break printf
run < payload
x/10wx 0x8049ff0
break puts
c
x/10wx 0x8049ff0
c
x/10wx 0x8049ff0
c
x/10wx 0x8049ff0
c
x/10wx 0x8049ff0
checksec
quit
break printf
run < payload 
x/10wx 08049bc0
x/10wx 0x8049bc0
c
x/10wx 0x8049bc0
c
x/10wx 0x8049bc0
c
x/10wx 0x8049bc0
b puts
c
b puts
x/10wx 0x8049bc0
pdisas do_the_format
pdisas do_the_format
q
break printf
x/10wx 0x8049bc0
x/10wx 0x8049bc0
x/10wx 0x08049bc0
x/10wx 0x08049bc0
x/10wx 0x08049bc0
x/10wx 0x08049bc0
run < payload 
x/10wx 0x08049bc0
c
x/10wx 0x08049bc0
c
x/10wx 0x08049bc0
c
x/10wx 0x08049bc0
pdisas do_the
pdisas do_the_format
b *0x0804861a 
c
x/10wx 0x08049bc0
c
qq
q
pdsias main
pdisas main
q
q
pdisas do_the_format
q
b do_the_format
run < payload
ni
stepuntill printf
stepuntil printf
run < payload
c
where
run < payload
b printf
c
c
c
x/10wx 0x08049bc0
c
x/10wx 0x08049bc0
c
x/10wx 0x08049bc0
pdisas do_the_format
q
pdisas do_the_format
q
start
p system
p libc_start
p __libc_start_main
q
